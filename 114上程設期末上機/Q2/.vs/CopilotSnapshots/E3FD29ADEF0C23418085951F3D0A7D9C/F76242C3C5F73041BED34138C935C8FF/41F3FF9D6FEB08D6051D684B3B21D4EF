# 汽車維修服務管理系統 - 程式設計考題

## 題目概述

請開發一個 Windows Forms 應用程式，用於管理汽車維修服務的費用計算和明細記錄。此系統需要能夠處理不同類型的維修服務、計算相關費用，並提供完整的報表功能。

## 系統功能需求

### 1. 服務項目管理
設計一個使用者友善的介面，讓使用者能夠選擇以下維修服務類別：

- **機油與潤滑服務**：包含更換機油和潤滑保養等基本維護項目
- **清洗服務**：提供水箱清洗和變速箱清洗等深度清潔服務
- **其他維修服務**：涵蓋檢驗、零件更換、輪胎相關服務等

每項服務都有固定的收費標準，系統需要根據使用者的選擇自動計算對應費用。

### 2. 零件與工時計算
系統必須支援彈性的費用輸入機制：

- 允許使用者輸入零件費用（以新台幣計算）
- 提供工時數輸入功能，並根據每小時固定費率自動計算工資
- 對零件費用收取適當的稅金（6% 稅率）

### 3. 費用計算與顯示
開發完整的費用計算邏輯：

- 即時計算所有選定服務的總額
- 分別顯示服務費用、零件費用、稅金等明細
- 計算並顯示最終的總費用
- 確保所有金額格式化為適當的貨幣顯示格式

#### 費用計算規則
- **機油更換**：NT$780
- **潤滑保養**：NT$540  
- **水箱清洗**：NT$900
- **變速箱清洗**：NT$2,400
- **檢驗**：NT$450
- **更換消音器**：NT$3,000
- **輪胎換位**：NT$600
- **工時費率**：NT$600/小時
- **零件稅率**：6%（僅對零件收取）

#### 計算邏輯
1. 服務與工資總額 = 所有選定服務費用 + 工時費用
2. 稅金 = 零件費用 × 6%
3. 總費用 = 服務與工資總額 + 零件費用 + 稅金

### 4. 資料管理功能
實作基本的資料操作功能：

- 提供清除功能，可以重設所有輸入和選項
- 實作計算功能，更新所有費用顯示
- 加入適當的資料驗證機制

### 5. 報表輸出功能
開發檔案輸出功能，讓使用者能夠：

- 將完整的維修明細儲存為文字檔案
- 包含所有服務項目、費用明細、計算過程
- 提供專業格式的報表版面，包含日期時間、分類整理等
- 在程式結束前詢問使用者是否需要儲存明細

## 技術實作要求

### 介面設計
- 使用 Windows Forms 技術建立圖形化使用者介面
- 採用適當的控制項（CheckBox、TextBox、Label、Button、GroupBox 等）
- 設計清晰的版面配置，將相關功能分組顯示
- 確保介面直觀易用，符合一般使用者習慣

### 程式架構
- 建立適當的方法來處理不同類別的費用計算
- 實作事件處理機制來回應使用者操作
- 使用有意義的變數和方法命名
- 加入適當的程式註解和文件說明

#### 建議的方法結構

**費用計算方法：**
- `OilLubeCharges()` - 計算機油和潤滑服務費用
- `FlushCharges()` - 計算清洗服務費用  
- `MiscCharges()` - 計算其他服務費用
- `OtherCharges()` - 計算零件和工時費用
- `TaxCharges()` - 計算稅金（零件6%稅率）
- `TotalCharges()` - 計算所有費用總和

**事件處理方法：**
- `calculateButton_Click()` - 計算總額按鈕點擊事件
- `clearButton_Click()` - 清除按鈕點擊事件
- `exitButton_Click()` - 離開按鈕點擊事件

**資料清除方法：**
- `ClearOilLube()` - 清除機油潤滑選項
- `ClearFlushes()` - 清除清洗服務選項
- `ClearMisc()` - 清除其他服務選項
- `ClearOther()` - 清除零件和工時輸入
- `ClearFees()` - 清除費用顯示

**檔案處理方法：**
- `SaveServiceDetailsToFile()` - 儲存維修明細到檔案

**變數建議：**
- 使用 `decimal` 型別儲存各項費用金額
- 定義常數 `LABOR_RATE_PER_HOUR` 存放每小時工資費率
- 適當的控件命名（如 `calculateButton`, `clearButton`, `exitButton`）

### 資料處理
- 實作安全的數值解析機制，處理使用者輸入的錯誤情況
- 使用適當的資料型別來儲存金額（建議使用 decimal）
- 實作檔案 I/O 功能，能夠建立和寫入文字檔案
- 確保程式能夠處理例外情況並提供適當的錯誤訊息

#### 資料處理實作要點

**數值解析：**
- 使用 `decimal.TryParse()` 安全解析使用者輸入
- 處理空值或無效輸入，設定適當的預設值
- 驗證輸入範圍的合理性（例如：不可為負數）

**檔案 I/O 操作：**
- 使用 `SaveFileDialog` 讓使用者選擇儲存位置
- 使用 `File.CreateText()` 或 `StreamWriter` 建立文字檔案
- 實作 `try-catch-finally` 確保檔案資源正確釋放
- 使用 UTF-8 編碼確保中文字元正確顯示

**例外處理範例：**
```csharp
try 
{
    // 檔案寫入操作
    writer = File.CreateText(fileName);
    writer.WriteLine("內容");
}
catch (Exception ex) 
{
    MessageBox.Show("儲存失敗：" + ex.Message);
}
finally 
{
    if (writer != null) writer.Close();
}
```

### 使用者體驗
- 提供即時的費用計算回饋
- 實作確認對話框，避免意外的資料遺失
- 加入適當的提示訊息和狀態顯示
- 確保程式執行穩定，不會因使用者操作而當機

## 評分重點

### 功能完整性（40%）
- 所有必要功能都能正常運作
- 費用計算邏輯正確無誤
- 檔案儲存功能運作正常
- 使用者介面回應適當

### 程式品質（35%）
- 程式碼結構清晰，邏輯易於理解
- 使用適當的程式設計模式和最佳實踐
- 變數和方法命名具有描述性
- 程式註解完整且有意義

### 錯誤處理（15%）
- 能夠適當處理使用者輸入錯誤
- 檔案操作包含例外處理機制
- 提供有意義的錯誤訊息
- 程式執行穩定可靠

### 介面設計（10%）
- 介面佈局清晰美觀
- 控制項使用適當
- 使用者操作流程順暢
- 符合一般軟體使用習慣

## 進階挑戰（加分項目）

如果時間充裕，可以考慮加入以下進階功能：

- **資料驗證增強**：加入更完善的輸入驗證機制，確保資料格式正確
- **歷史記錄**：實作簡單的記錄功能，能夠檢視之前的維修明細
- **列印預覽**：提供明細的列印預覽功能
- **設定管理**：允許使用者調整服務項目的收費標準
- **多語言支援**：加入基本的多語言切換功能

## 提交要求

### 程式檔案
- 完整的 Visual Studio 專案檔案
- 包含所有原始程式碼檔案（.cs, .Designer.cs, .resx 等）
- 確保專案能夠正常編譯和執行

#### 程式碼檢查重點
**必要方法：**
- [ ] 費用計算方法群組（OilLubeCharges, FlushCharges, MiscCharges 等）
- [ ] 事件處理方法（calculateButton_Click, clearButton_Click, exitButton_Click）
- [ ] 資料清除方法群組（ClearOilLube, ClearFlushes, ClearMisc 等）
- [ ] 檔案儲存方法（SaveServiceDetailsToFile）

**程式品質：**
- [ ] 適當的變數命名（有意義、符合慣例）
- [ ] 完整的程式註解和 XML 文件註解
- [ ] 適當的例外處理機制
- [ ] 正確的資源釋放（檔案處理）

### 說明文件
- 簡要的系統操作說明
- 主要功能的使用方法介紹
- 已知問題或限制說明（如有）

### 測試資料
- 提供幾組測試案例，展示不同功能的使用情況
- 包含正常操作和異常輸入的測試結果

## 開發提示

- 在開始撰寫程式前，先仔細規劃介面佈局和程式架構
- 建議採用漸進式開發，先完成基本功能再加入進階特色
- 注意程式的可讀性和維護性，這在實際工作中非常重要
- 測試時要考慮各種可能的使用情況，包含異常操作
- 善用 Visual Studio 的除錯功能來檢查程式邏輯

### 建議的開發順序

**第一階段：介面設計**
1. 建立 Windows Forms 專案
2. 設計表單佈局，加入所需的控制項
3. 設定控制項的 Name 屬性為有意義的名稱
4. 調整介面美觀度和使用性

**第二階段：基本計算功能**
1. 定義變數儲存各項費用金額
2. 實作各項服務的費用計算方法
3. 實作計算總額的事件處理
4. 測試費用計算邏輯的正確性

**第三階段：資料管理**
1. 實作清除功能的各個方法
2. 加入輸入驗證機制
3. 測試資料重設功能

**第四階段：檔案輸出**
1. 實作儲存檔案的對話框
2. 建立檔案寫入邏輯
3. 設計專業的報表格式
4. 加入例外處理機制

**第五階段：整合測試**
1. 全面測試所有功能組合
2. 處理邊界案例和異常輸入
3. 優化使用者體驗
4. 完善程式註解和文件

### 常見技術要點

**金額格式化：**
- 使用 `.ToString("C0")` 顯示無小數的新台幣格式
- 例如：`1000.ToString("C0")` 顯示為 "NT$1,000"

**事件處理命名：**
- 按鈕事件：`控制項名稱_Click`
- 例如：`calculateButton_Click`、`clearButton_Click`

**檔案命名建議：**
- 使用日期時間：`"維修明細_" + DateTime.Now.ToString("yyyyMMdd_HHmmss") + ".txt"`
- 例如：維修明細_20241201_143052.txt

## 學習目標

透過這個專題，學生將能夠：

- 熟練運用 Windows Forms 開發技術
- 掌握事件驅動程式設計的概念
- 學習檔案 I/O 操作的實作方法
- 了解使用者介面設計的基本原則
- 培養程式除錯和測試的能力
- 體驗完整軟體開發流程的各個階段

---

**注意事項：** 此考題旨在評估學生的程式設計能力和問題解決技巧。請獨立完成，並確保程式碼的原創性。如有疑問，請適時尋求指導老師的協助。